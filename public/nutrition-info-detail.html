<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì–‘ ì •ë³´ ìƒì„¸ - ì‡í”Œ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="nutrition-info-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @media (max-width: 768px) {
            .footer {
                display: none;
            }
        }
    </style>
</head>
<body class="nutrition-detail-page">
    <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-content">
                <div class="nav-brand">
                    <a href="index.html">ì‡í”Œ</a>
                </div>
                <div class="nav-menu">
                    <a href="meal-plan.html">ë­í•´ë¨¹ì§€?</a>
                    <a href="supplements.html">ë‚˜ë§Œì˜ ì˜ì–‘ì œ</a>
                    <a href="restaurant-recommendation.html">ì˜¤ëŠ˜ì˜ ë§›ì§‘</a>
                    <a href="nutrition-info.html">ì‡í”Œ ì¸ì‚¬ì´íŠ¸</a>
                    <a href="ingredient-analyzer.html">ì‹ì¬ë£Œ ë¶„ì„</a>
                </div>
                <div class="nav-auth" id="navAuth">
                    <a href="login.html" class="main-nav-button">ë¡œê·¸ì¸</a>
                    <a href="signup.html" class="main-nav-button primary">íšŒì›ê°€ì…</a>
                </div>
                <div class="nav-toggle" id="navToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- ë¡œë”© ìƒíƒœ -->
    <div id="loadingState" class="detail-loading-container">
        <div class="loading-spinner"></div>
        <p>ì˜ì–‘ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    </div>

    <!-- ì—ëŸ¬ ìƒíƒœ -->
    <div id="errorState" class="detail-error-container" style="display: none;">
        <div class="error-icon">âš ï¸</div>
        <h3>ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>
        <p id="errorMessage">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>
        <div class="error-actions">
            <button id="retryBtn" class="retry-btn">ë‹¤ì‹œ ì‹œë„</button>
            <a href="nutrition-info.html" class="back-btn">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </div>

    <!-- ìƒì„¸ ì½˜í…ì¸  -->
    <div id="detailContent" class="detail-content" style="display: none;">
        <!-- ë¸Œë ˆë“œí¬ëŸ¼ -->
        <section class="breadcrumb-section">
            <div class="container">
                <nav class="breadcrumb">
                    <a href="index.html">í™ˆ</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <a href="nutrition-info.html">ì˜ì–‘ ì •ë³´</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <span id="breadcrumbTitle">ìƒì„¸ ì •ë³´</span>
                </nav>
            </div>
        </section>

        <!-- ë©”ì¸ í—¤ë” -->
        <section class="detail-header">
            <div class="container">
                <div class="detail-header-content">
                    <div class="detail-meta">

                    </div>
                    <h1 class="detail-title" id="detailTitle">ì˜ì–‘ ì •ë³´ ì œëª©</h1>
                    <div class="detail-source-info">
                        <span class="detail-source" id="detailSource">ì¶œì²˜ëª…</span>
                        <span class="detail-date" id="detailDate">2025.01.19</span>
                        <span class="detail-author" id="detailAuthor">ì €ìëª…</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <section class="detail-main">
            <div class="container">
                <div class="detail-layout">
                    <!-- ì¢Œì¸¡ ì½˜í…ì¸  -->
                    <div class="detail-content-area">
                        <!-- ì´ë¯¸ì§€ -->
                        <div class="detail-image-container">
                            <img id="detailImage" src="" alt="ì˜ì–‘ ì •ë³´ ì´ë¯¸ì§€" class="detail-image">
                        </div>

                        <!-- ìš”ì•½ -->
                        <div class="detail-summary-section">
                            <h2 class="section-title">ìš”ì•½</h2>
                            <div class="detail-summary" id="detailSummary">
                                ì˜ì–‘ ì •ë³´ ìš”ì•½ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                            </div>
                        </div>

                        <!-- ìƒì„¸ ë‚´ìš© -->
                        <div class="detail-content-section" id="detailContentSection" style="display: none;">
                            <h2 class="section-title">ìƒì„¸ ë‚´ìš©</h2>
                            <div class="detail-main-content" id="detailMainContent">
                                ìƒì„¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                            </div>
                        </div>

                        <!-- ì›ë³¸ ì†ŒìŠ¤ ë§í¬ -->
                        <div class="detail-source-section">
                            <h3 class="section-subtitle">ì›ë³¸ ì†ŒìŠ¤</h3>
                            <div class="detail-source-url">
                                <a id="detailSourceLink" href="#" target="_blank" rel="noopener noreferrer" class="source-url-link">
                                    <span class="source-url-text">ì›ë³¸ ë§í¬ ì£¼ì†Œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
                                </a>
                            </div>
                        </div>

                        <!-- ê´€ë ¨ ìƒí’ˆ -->
                        <div class="detail-products-section" id="detailProductsSection" style="display: none;">
                            <h3 class="section-subtitle">ê´€ë ¨ ìƒí’ˆ</h3>
                            <div class="detail-products" id="detailProducts">
                                <!-- ìƒí’ˆë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </div>
                        </div>

                        <!-- íƒœê·¸ -->
                        <div class="detail-tags-section">
                            <h3 class="section-subtitle">ê´€ë ¨ íƒœê·¸</h3>
                            <div class="detail-tags" id="detailTags">
                                <!-- íƒœê·¸ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </div>
                        </div>

                        <!-- ì•¡ì…˜ ë²„íŠ¼ -->
                        <div class="detail-actions">
                            <button class="detail-action-btn bookmark-btn" id="detailBookmarkBtn">
                                <span class="nutrition-action-icon">ğŸ”–</span>
                                <span class="action-text">ë¶ë§ˆí¬</span>
                            </button>
                            <button class="detail-action-btn share-btn" id="detailShareBtn">
                                <span class="nutrition-action-icon">ğŸ“¤</span>
                                <span class="action-text">ê³µìœ </span>
                            </button>
                        </div>

                        <!-- ì›ë³¸ ì½˜í…ì¸  (ë…¼ë¬¸ì˜ ê²½ìš°) -->
                        <div class="detail-original-section" id="originalSection" style="display: none;">
                            <h2 class="section-title">ì›ë³¸ ë‚´ìš©</h2>
                            <div class="detail-original-content" id="detailOriginalContent">
                                ì›ë³¸ ì½˜í…ì¸ ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ì¶”ì²œ ì„¹ì…˜ -->
        <section class="detail-recommendations">
            <div class="container">
                <h2 class="section-title">ê´€ë ¨ ì¶”ì²œ ì •ë³´</h2>
                <div id="recommendedInfo" class="recommended-grid">
                    <!-- ì¶”ì²œ ì •ë³´ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </section>
    </div>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="brand-logo">ì‡í”Œ</div>
                    <p>ê±´ê°•í•œ ì‹ìƒí™œì„ ìœ„í•œ ì¢…í•© í”Œë«í¼</p>
                </div>
                <div class="footer-links">
                    <div class="footer-section">
                        <h4>ì„œë¹„ìŠ¤</h4>
                        <ul>
                            <li><a href="meal-plan.html">ë­í•´ë¨¹ì§€?</a></li>
                            <li><a href="supplements.html">ë‚˜ë§Œì˜ ì˜ì–‘ì œ</a></li>
                            <li><a href="restaurant-recommendation.html">ì˜¤ëŠ˜ì˜ ë§›ì§‘</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h4>ê³ ê°ì§€ì›</h4>
                        <ul>
                            <li><a href="index.html#faq">ìì£¼ë¬»ëŠ”ì§ˆë¬¸</a></li>
                            <li><a href="#contact">ë¬¸ì˜í•˜ê¸°</a></li>
                            <li><a href="#privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 ì‡í”Œ. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="nutrition-info-detail.js"></script>
    <script src="script.js"></script>
    <script>
        // ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ í† ê¸€ (index.htmlê³¼ ë™ì¼)
        document.getElementById('navToggle').addEventListener('click', function () {
            const navMenu = document.querySelector('.nav-menu');
            const navAuth = document.querySelector('.nav-auth');
            navMenu.classList.toggle('active');
            navAuth.classList.toggle('active');
            this.classList.toggle('active');
        });
        // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        async function checkAuthStatus() {
            const navAuth = document.getElementById('navAuth');
            
            try {
                const response = await fetch('/api/auth/me', {
                    credentials: 'include'
                });
                const data = await response.json();
                
                if (data.loggedIn && data.user) {
                    localStorage.setItem('user', JSON.stringify(data.user));
                    navAuth.innerHTML = `
                        <a href="mypage.html" class="main-nav-button">ë§ˆì´í˜ì´ì§€</a>
                        <button class="main-nav-button" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                    `;
                } else {
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    navAuth.innerHTML = `
                        <a href="login.html" class="main-nav-button">ë¡œê·¸ì¸</a>
                        <a href="signup.html" class="main-nav-button primary">íšŒì›ê°€ì…</a>
                    `;
                }
            } catch (error) {
                console.error('Auth status check failed:', error);
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                navAuth.innerHTML = `
                    <a href="login.html" class="main-nav-button">ë¡œê·¸ì¸</a>
                    <a href="signup.html" class="main-nav-button primary">íšŒì›ê°€ì…</a>
                `;
            }
        }

        async function logout() {
            try {
                await fetch('/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include'
                });
            } catch (error) {
                console.error('Logout failed:', error);
            }
            
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            location.reload();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        checkAuthStatus();
    </script>
</body>
</html>