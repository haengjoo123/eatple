<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>카테고리 - 잇플 스토어</title>
    <link rel="stylesheet" href="category.css" />
    <link rel="stylesheet" href="collection-groups.css" />
    <link rel="stylesheet" href="mobile-optimizations.css" />
    <link rel="stylesheet" href="store.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- 헤더 상단 -->
    <div class="header-top" id="headerTop">
      <div class="container">
        <div class="header-top-content">
          <div class="header-left">
            <a href="store.html" class="logo">
              <img src="images/eatplelogo.png" alt="잇플" class="logo-image">
            </a>
          </div>

          <div class="header-center">
            <div class="search-container">
              <input
                type="text"
                class="search-input"
                placeholder="검색어를 입력해주세요"
              />
              <button class="search-btn">
                <svg
                  class="search-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8"></circle>
                  <path d="m21 21-4.35-4.35"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="header-right">
            <div class="header-right-section">
              <div class="header-links">
                <a href="login.html" class="header-link">로그인</a>
                <a href="signup.html" class="header-link">회원가입</a>
                <a href="#support" class="header-link">고객센터</a>
              </div>
              <div class="header-actions">
                <button class="action-btn user-btn">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                </button>

                <button class="action-btn cart-btn">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path
                      d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                    ></path>
                  </svg>
                  <span class="cart-count">0</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 헤더 네비게이션 -->
    <nav class="header-nav" id="headerNav">
      <div class="container">
        <div class="nav-container">
          <div class="nav-left-group">
            <div class="category-dropdown">
              <button class="category-btn">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
                카테고리
              </button>
              <div class="category-dropdown-menu">
                <div class="category-dropdown-section">
                  <h4 class="category-dropdown-header">건강식품</h4>
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=health_functional_food"
                    >건강기능식품</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=protein_food"
                    >단백질 식품</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=healthy_snack"
                    >건강 간식</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=healthy_juice"
                    >건강 주스</a
                  >
                </div>
                <div class="category-dropdown-section">
                  <h4 class="category-dropdown-header">간편식/반찬</h4>
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=home_meal_replacement"
                    >가정간편식</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=side_dish"
                    >반찬</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=salad"
                    >샐러드</a
                  >
                </div>
                <div class="category-dropdown-section">
                  <h4 class="category-dropdown-header">신선식품</h4>
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=fruit"
                    >과일</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=meat"
                    >정육/계란</a
                  >
                  <a
                    class="category-dropdown-item"
                    href="category.html?category=seafood"
                    >수산/해산</a
                  >
                </div>
              </div>
            </div>
            <ul class="nav-menu">
              <li class="nav-item">
                <a class="nav-link" href="collection-groups.html?group=best">베스트</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="collection-groups.html?group=new">신상품</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="collection-groups.html?group=sale">특가상품</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="event.html">이벤트</a>
              </li>
            </ul>
          </div>
          <div class="header-actions-nav">
            <button class="action-btn user-btn">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </button>

            <button class="action-btn cart-btn">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path
                  d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                ></path>
              </svg>
              <span class="cart-count">0</span>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- 모바일 브레드크럼 (모바일에서만 표시) -->
    <section class="mobile-breadcrumb-section">
      <div class="container">
        <nav class="mobile-breadcrumb" id="mobileBreadcrumb">
          <a href="store.html" class="breadcrumb-item">홈</a>
          <span class="breadcrumb-separator">></span>
          <a href="#" class="breadcrumb-item" id="parentCategory">카테고리</a>
          <span class="breadcrumb-separator">></span>
          <span class="breadcrumb-item current" id="currentCategory">서브카테고리</span>
        </nav>
      </div>
    </section>



    <!-- 카테고리 헤더 -->
    <section class="category-header">
      <div class="container">
        <div class="category-header-content">
          <div class="category-info">
            <h1 class="category-title" id="categoryTitle">카테고리</h1>
            <div class="category-stats">
              <span class="product-count"
                >총 <span id="productCount">0</span>개</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 필터 및 정렬 -->
    <section class="filter-section">
      <div class="container">
        <!-- PC용 필터 -->
        <div class="filter-bar pc-filter-bar">
          <div class="filter-left">
            <div class="filter-group">
              <div class="filter-options">
                                 <button class="filter-btn active" data-filter="추천순">
                   추천순
                 </button>
                <button class="filter-btn" data-filter="추천순">추천순</button>
                <button class="filter-btn" data-filter="신상품">신상품</button>
                <button class="filter-btn" data-filter="판매순">판매순</button>
                <button class="filter-btn" data-filter="혜택순">혜택순</button>
                <button class="filter-btn" data-filter="낮은 가격순">
                  낮은 가격순
                </button>
              </div>
            </div>
          </div>
          <div class="filter-right">
            <div class="sort-group">
              <label class="sort-label">가격</label>
              <div class="price-filter">
                <input
                  type="number"
                  class="price-input"
                  placeholder="최소"
                  id="pcMinPrice"
                />
                <span class="price-separator">~</span>
                <input
                  type="number"
                  class="price-input"
                  placeholder="최대"
                  id="pcMaxPrice"
                />
                <button class="price-apply-btn" id="pcApplyPriceFilter">
                  적용
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 모바일용 필터 (PC에서는 숨김) -->
        <div class="mobile-filter-section">
          <div class="filter-bar mobile-filter-bar">
            <div class="filter-left">
              <div class="product-count-container">
                <span class="product-count">총 <span id="mobileProductCount">0</span>개</span>
              </div>
            </div>
            <div class="filter-right">
              <div class="sort-filter-group">
                <div class="sort-dropdown">
                  <button class="sort-btn" id="sortBtn">
                                         <span class="sort-text">추천순</span>
                    <svg class="sort-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <polyline points="6,9 12,15 18,9"></polyline>
                    </svg>
                  </button>
                                     <div class="sort-dropdown-menu" id="sortDropdown">
                     <button class="sort-option" data-sort="추천순">추천순</button>
                     <button class="sort-option" data-sort="신상품">신상품</button>
                     <button class="sort-option" data-sort="판매순">판매순</button>
                     <button class="sort-option" data-sort="혜택순">혜택순</button>
                     <button class="sort-option" data-sort="낮은 가격순">낮은 가격순</button>
                   </div>
                </div>
                <button class="filter-toggle-btn" id="filterToggleBtn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                  </svg>
                  필터
                </button>
              </div>
            </div>
          </div>
          
          <!-- 확장 가능한 필터 옵션 -->
          <div class="filter-expanded" id="filterExpanded" style="display: none;">
                         <div class="filter-options">
               <button class="filter-btn active" data-filter="추천순">추천순</button>
               <button class="filter-btn" data-filter="신상품">신상품</button>
               <button class="filter-btn" data-filter="판매순">판매순</button>
               <button class="filter-btn" data-filter="혜택순">혜택순</button>
               <button class="filter-btn" data-filter="낮은 가격순">낮은 가격순</button>
             </div>
            <div class="price-filter-section">
              <label class="price-filter-label">가격 범위</label>
              <div class="price-filter">
                <input type="number" class="price-input" placeholder="최소" id="mobileMinPrice" />
                <span class="price-separator">~</span>
                <input type="number" class="price-input" placeholder="최대" id="mobileMaxPrice" />
                <button class="price-apply-btn" id="mobileApplyPriceFilter">적용</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 상품 목록 -->
    <main class="category-main">
      <div class="container">
        <div class="products-section">
          <div class="products-grid" id="productsGrid">
            <!-- 상품들이 JavaScript로 생성됩니다 -->
          </div>

          <!-- 로딩 상태 -->
          <div class="loading-state" id="loadingState" style="display: none">
            <div class="spinner"></div>
            <p>상품을 불러오는 중...</p>
          </div>

          <!-- 빈 상태 -->
          <div class="empty-state" id="emptyState" style="display: none">
            <div class="empty-icon">📦</div>
            <h3>상품이 없습니다</h3>
            <p>
              해당 카테고리에 상품이 없거나 필터 조건에 맞는 상품이 없습니다.
            </p>
            <button
              class="btn-primary"
              onclick="window.location.href='store.html'"
            >
              전체 상품 보기
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- 상품 상세 모달 -->
    <div id="productDetailModal" class="modal">
      <div class="modal-content product-detail-modal">
        <div class="modal-header">
          <h2 class="modal-title" id="productDetailTitle">상품 상세</h2>
          <button class="modal-close" id="productDetailClose">&times;</button>
        </div>

        <div class="modal-body">
          <div class="product-detail-content">
            <div class="product-detail-image">
              <div id="productDetailImageContainer"></div>
            </div>
            <div class="product-detail-info">
              <h3 id="productDetailName"></h3>
              <p id="productDetailSummary"></p>
              <div class="price-quantity-row">
                <div class="product-detail-price">
                  <span class="current-price" id="productDetailPrice"></span>
                  <span
                    class="original-price"
                    id="productDetailOriginalPrice"
                  ></span>
                </div>
                <div class="quantity-section">
                  <div class="quantity-controls">
                    <button type="button" class="quantity-btn" id="decreaseQty">
                      -
                    </button>
                    <input
                      type="number"
                      class="quantity-input"
                      id="quantityInput"
                      value="1"
                      min="1"
                      max="10"
                    />
                    <button type="button" class="quantity-btn" id="increaseQty">
                      +
                    </button>
                  </div>
                </div>
              </div>
              <div class="total-section">
                <span>합계</span>
                <span class="total-price" id="totalPrice">29,900원</span>
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer product-detail-footer">
          <button
            type="button"
            class="modal-btn cancel-btn"
            id="productDetailCancel"
          >
            취소
          </button>
          <button
            type="button"
            class="modal-btn confirm-btn"
            id="addToCartBtn"
          >
            장바구니 담기
          </button>
        </div>
      </div>
    </div>

    <!-- 구매 모달 (store.html과 동일) -->
    <div id="purchaseModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">상품 구매</h2>
          <button class="modal-close" id="modalClose">&times;</button>
        </div>

        <div class="modal-body">
          <div class="error-message" id="errorMessage"></div>
          <div class="success-message" id="successMessage"></div>

          <div class="loading" id="loadingSpinner">
            <div class="spinner"></div>
            <p>처리 중...</p>
          </div>

          <div id="purchaseForm">
            <div class="purchase-summary" id="purchaseSummary">
              <!-- 구매 요약이 JavaScript로 생성됩니다 -->
            </div>

            <div class="points-section">
              <label class="points-label">사용할 포인트</label>
              <div class="points-input-group">
                <input
                  type="number"
                  id="pointsInput"
                  class="points-input"
                  min="0"
                  max="0"
                  placeholder="0"
                />
                <button type="button" class="max-points-btn" id="maxPointsBtn">
                  최대
                </button>
              </div>
              <div class="points-info">
                보유 포인트: <span id="availablePoints">0</span>P (1포인트 = 1원
                할인)
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="modal-btn cancel-btn" id="cancelBtn">
            취소
          </button>
          <button type="button" class="modal-btn confirm-btn" id="confirmBtn">
            구매하기
          </button>
        </div>
      </div>
    </div>

    <!-- 모바일 하단 네비게이션 바 -->
    <nav class="store-footer-nav-mobile">
      <ul>
        <li class="store-footer-nav-item" id="storeNavHome">
          <a href="store.html">
            <span class="store-footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9,22 9,12 15,12 15,22"></polyline>
              </svg>
            </span>
          </a>
        </li>
        <li class="store-footer-nav-item" id="storeNavMenu">
          <button type="button" class="store-footer-nav-menu-btn">
            <span class="store-footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </span>
          </button>
        </li>
        <li class="store-footer-nav-item" id="storeNavSearch">
          <button type="button" class="store-footer-nav-search-btn">
            <span class="store-footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
              </svg>
            </span>
          </button>
        </li>
        <li class="store-footer-nav-item" id="storeNavMy">
          <button type="button" class="store-footer-nav-my-btn">
            <span class="store-footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </span>
          </button>
        </li>
      </ul>
    </nav>

    <!-- 햄버거 메뉴 모달 -->
    <div id="storeHamburgerModal" class="store-hamburger-modal">
      <div class="store-hamburger-modal-content">
        <div class="hamburger-menu-layout">
          <!-- 왼쪽 상위 카테고리 -->
          <div class="main-categories">
            <div class="category-item" data-category="health">
              <span>건강식품</span>
            </div>
            <div class="category-item" data-category="convenient">
              <span>간편식/반찬</span>
            </div>
            <div class="category-item active" data-category="fresh">
              <span>신선식품</span>
            </div>
          </div>
          
          <!-- 오른쪽 서브카테고리 -->
          <div class="sub-categories">
            <!-- 건강식품 서브카테고리 -->
            <div class="sub-category-group" data-category="health">
              <div class="sub-category-header">
                <div class="sub-category-icon">🏥</div>
                <span>건강식품</span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
              </div>
              <ul class="sub-category-list">
                <li><a href="category.html?category=health_functional_food">건강기능식품</a></li>
                <li><a href="category.html?category=protein_food">단백질 식품</a></li>
                <li><a href="category.html?category=healthy_snack">건강 간식</a></li>
                <li><a href="category.html?category=healthy_juice">건강 주스</a></li>
              </ul>
            </div>
            
            <!-- 간편식/반찬 서브카테고리 -->
            <div class="sub-category-group" data-category="convenient">
              <div class="sub-category-header">
                <div class="sub-category-icon">🍽️</div>
                <span>간편식/반찬</span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
              </div>
              <ul class="sub-category-list">
                <li><a href="category.html?category=home_meal_replacement">가정간편식</a></li>
                <li><a href="category.html?category=side_dish">반찬</a></li>
                <li><a href="category.html?category=salad">샐러드</a></li>
              </ul>
            </div>
            
            <!-- 신선식품 서브카테고리 -->
            <div class="sub-category-group active" data-category="fresh">
              <div class="sub-category-header">
                <div class="sub-category-icon">🍎</div>
                <span>신선식품</span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
              </div>
              <ul class="sub-category-list">
                <li><a href="category.html?category=fruit">과일</a></li>
                <li><a href="category.html?category=meat">정육/계란</a></li>
                <li><a href="category.html?category=seafood">수산/해산</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="header-auth.js"></script>
    <script src="category.js"></script>
    <script>
      // 모바일 하단 네비게이션 기능
      document.addEventListener('DOMContentLoaded', function() {
        const hamburgerBtn = document.querySelector('.store-footer-nav-menu-btn');
        const hamburgerModal = document.getElementById('storeHamburgerModal');
        const searchBtn = document.querySelector('.store-footer-nav-search-btn');
        const myBtn = document.querySelector('.store-footer-nav-my-btn');

        // 햄버거 메뉴 열기/닫기 토글
        if (hamburgerBtn) {
          hamburgerBtn.addEventListener('click', function() {
            // 모달이 이미 열려있으면 닫기, 아니면 열기
            if (hamburgerModal.classList.contains('active')) {
              hamburgerModal.classList.remove('active');
            } else {
              hamburgerModal.classList.add('active');
            }
          });
        }

        // 모달 외부 클릭 시 닫기
        if (hamburgerModal) {
          hamburgerModal.addEventListener('click', function(e) {
            if (e.target === hamburgerModal) {
              hamburgerModal.classList.remove('active');
            }
          });
        }

        // 검색 버튼 클릭 시 상단 검색 입력창으로 스크롤
        if (searchBtn) {
          searchBtn.addEventListener('click', function() {
            const searchInput = document.querySelector('.search-input');
            if (searchInput) {
              searchInput.focus();
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }
          });
        }

        // 마이페이지 버튼 클릭 시 마이페이지 모달 열기 (기존 기능 활용)
        if (myBtn) {
          myBtn.addEventListener('click', function() {
            // 로그인 상태 확인 후 마이페이지 모달 열기
            const userBtn = document.querySelector('.user-btn');
            if (userBtn) {
              userBtn.click();
            }
          });
        }

        // 햄버거 메뉴 카테고리 전환 기능
        const categoryItems = document.querySelectorAll('.category-item');
        const subCategoryGroups = document.querySelectorAll('.sub-category-group');

        categoryItems.forEach(item => {
          item.addEventListener('click', function() {
            const category = this.getAttribute('data-category');
            
            // 모든 카테고리 아이템에서 active 클래스 제거
            categoryItems.forEach(cat => cat.classList.remove('active'));
            // 클릭된 카테고리 아이템에 active 클래스 추가
            this.classList.add('active');
            
            // 모든 서브카테고리 그룹 숨기기
            subCategoryGroups.forEach(group => group.classList.remove('active'));
            // 해당하는 서브카테고리 그룹 보이기
            const targetGroup = document.querySelector(`.sub-category-group[data-category="${category}"]`);
            if (targetGroup) {
              targetGroup.classList.add('active');
            }
          });
        });
      });
    </script>
  </body>
</html>
