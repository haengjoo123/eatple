<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‡í”Œ ì¸ì‚¬ì´íŠ¸</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="nutrition-info-styles.css" />
    <style>
      @media (max-width: 768px) {
        .footer {
          display: none;
        }
      }
    </style>
  </head>
  <body class="nutrition-info-page">
    <div class="site-brand-fixed">
      <a href="index.html">
        <img src="images/eatplelogo.png" alt="ì‡í”Œ" class="logo-image">
      </a>
    </div>
    <div class="auth-links">
      <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
    </div>
    
    <!-- í˜ì´ì§€ ì œëª© -->
    <div class="page-title-header">
      <h1 class="page-title">ì‡í”Œ ì¸ì‚¬ì´íŠ¸</h1>
    </div>

    <!-- ì˜ì–‘ ì •ë³´ ëª©ë¡ ì„¹ì…˜ -->
    <section class="nutrition-content">
      <div class="container">
        <!-- í•„í„° ë° ê²€ìƒ‰ ì„¹ì…˜ -->
        <div class="nutrition-filters">
          <div class="filter-container">
            <!-- ê²€ìƒ‰ ë°” -->
            <div class="nutrition-search-container">
              <div class="nutrition-search-input-wrapper">
                <span class="nutrition-search-icon">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
                <input
                  type="text"
                  id="searchInput"
                  class="nutrition-search-input"
                  placeholder="ì˜ì–‘ ì •ë³´ ê²€ìƒ‰..."
                />
              </div>
            </div>
          </div>
        </div>

        <!-- ë¡œë”© ìƒíƒœ -->
        <div id="loadingState" class="loading-container">
          <div class="loading-spinner"></div>
          <p>ì˜ì–‘ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>

        <!-- ì—ëŸ¬ ìƒíƒœ -->
        <div id="errorState" class="error-container" style="display: none">
          <div class="error-icon">âš ï¸</div>
          <h3>ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>
          <p id="errorMessage">
            ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
          </p>
          <button id="retryBtn" class="retry-btn">ë‹¤ì‹œ ì‹œë„</button>
        </div>

        <!-- ë¹ˆ ìƒíƒœ -->
        <div id="emptyState" class="empty-container" style="display: none">
          <div class="empty-icon">ğŸ“„</div>
          <h3>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
          <p>ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë‚˜ í•„í„°ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”.</p>
        </div>

        <!-- ì˜ì–‘ ì •ë³´ ê·¸ë¦¬ë“œ -->
        <div id="nutritionGrid" class="nutrition-grid" style="display: none">
          <!-- ì˜ì–‘ ì •ë³´ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>

        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div
          id="paginationContainer"
          class="pagination-container"
          style="display: none"
        >
          <button id="prevPageBtn" class="pagination-arrow prev-arrow" disabled>
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M15 18L9 12L15 6"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
          <div id="pageNumbers" class="page-numbers"></div>
          <button id="nextPageBtn" class="pagination-arrow next-arrow" disabled>
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9 18L15 12L9 6"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
      </div>
    </section>

    <!-- í‘¸í„° -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-brand">
            <div class="brand-logo">
              <img src="images/eatplelogo.png" alt="ì‡í”Œ" class="logo-image">
            </div>
            <p>ê±´ê°•í•œ ì‹ìƒí™œì„ ìœ„í•œ ì¢…í•© í”Œë«í¼</p>
          </div>
          <div class="footer-links">
            <div class="footer-section">
              <h4>ì„œë¹„ìŠ¤</h4>
              <ul>
                <li><a href="meal-plan.html">ë­ í•´ë¨¹ì§€?</a></li>
                <li><a href="supplements.html">ë‚˜ë§Œì˜ ì˜ì–‘ì œ</a></li>
                <li><a href="restaurant-recommendation.html">ì˜¤ëŠ˜ì˜ ë§›ì§‘</a></li>
              </ul>
            </div>
            <div class="footer-section">
              <h4>ê³ ê°ì§€ì›</h4>
              <ul>
                <li><a href="index.html#faq">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a></li>
                <li><a href="#contact">ë¬¸ì˜í•˜ê¸°</a></li>
                <li><a href="#privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 ì‡í”Œ. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="footer-nav-mobile">
      <ul>
        <li class="footer-nav-item" id="footerNavHome">
          <a href="index.html">
            <span class="footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9,22 9,12 15,12 15,22"></polyline>
              </svg>
            </span>
            <span class="footer-nav-label">í™ˆ</span>
          </a>
        </li>
        <li class="footer-nav-item" id="footerNavNutrition">
          <a href="nutrition-info.html">
            <span class="footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14,2 14,8 20,8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10,9 9,9 8,9"></polyline>
              </svg>
            </span>
            <span class="footer-nav-label">ì˜ì–‘ì •ë³´</span>
          </a>
        </li>
        <li class="footer-nav-item" id="footerNavAI">
          <button type="button" class="footer-nav-ai-btn">
            <span class="footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4"></path>
                <path d="M21 12c-1 0-2-1-2-2s1-2 2-2 2 1 2 2-1 2-2 2z"></path>
                <path d="M3 12c1 0 2-1 2-2s-1-2-2-2-2 1-2 2 1 2 2 2z"></path>
                <path d="M12 3c0 1-1 2-2 2s-2-1-2-2 1-2 2-2 2 1 2 2z"></path>
                <path d="M12 21c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2z"></path>
              </svg>
            </span>
            <span class="footer-nav-label">AIê¸°ëŠ¥</span>
          </button>
        </li>
        <!-- ì‡í”ŒìŠ¤í† ì–´ ì¼ì‹œ ë¹„í™œì„±í™” - ì¬í™œì„±í™”ì‹œ ì£¼ì„ í•´ì œ -->
        <!--
        <li class="footer-nav-item" id="footerNavStore">
          <a href="store.html">
            <span class="footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
              </svg>
            </span>
            <span class="footer-nav-label">ìŠ¤í† ì–´</span>
          </a>
        </li>
        -->
        <li class="footer-nav-item" id="footerNavMy">
          <a href="mypage.html">
            <span class="footer-nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </span>
            <span class="footer-nav-label">ë§ˆì´</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- AI ê¸°ëŠ¥ ëª¨ë‹¬ -->
    <div id="aiFeatureModal" class="ai-feature-modal">
      <div class="ai-feature-modal-content">
        <ul>
          <li><a href="meal-plan.html">ë­ í•´ë¨¹ì§€?</a></li>
          <li><a href="supplements.html">ë‚˜ë§Œì˜ ì˜ì–‘ì œ</a></li>
          <li><a href="restaurant-recommendation.html">ì˜¤ëŠ˜ì˜ ë§›ì§‘</a></li>
        </ul>
      </div>
    </div>

    <script src="nutrition-info.js"></script>
    <script>
      // ì¸ì¦ ë§í¬ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      async function updateAuthLinks() {
        const authLinksContainer = document.querySelector(".auth-links");
        try {
          const response = await fetch("/api/auth/me", {
            credentials: "include",
          });
          const data = await response.json();

          if (data.loggedIn) {
            authLinksContainer.innerHTML = `
                        <a href="mypage.html">ë§ˆì´í˜ì´ì§€</a>
                        <a href="#" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</a>
                    `;
          } else {
            authLinksContainer.innerHTML = `
                        <a href="login.html">ë¡œê·¸ì¸</a>
                        <a href="signup.html">íšŒì›ê°€ì…</a>
                    `;
          }
        } catch (error) {
          console.error("ì¸ì¦ ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:", error);
          authLinksContainer.innerHTML = `
                    <a href="login.html">ë¡œê·¸ì¸</a>
                    <a href="signup.html">íšŒì›ê°€ì…</a>
                `;
        }
      }

      // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
      async function logout() {
        try {
          const response = await fetch("/api/auth/logout", {
            method: "POST",
            credentials: "include",
          });

          if (response.ok) {
            localStorage.removeItem("user");
            alert("ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.");
            window.location.href = "index.html";
          } else {
            alert("ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          }
        } catch (error) {
          console.error("ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:", error);
          alert("ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¸ì¦ ë§í¬ ì—…ë°ì´íŠ¸
      document.addEventListener("DOMContentLoaded", async function () {
        await updateAuthLinks();

        // footer-nav í™œì„± ìƒíƒœ ì„¤ì •
        const footerNavNutrition = document.getElementById("footerNavNutrition");
        if (footerNavNutrition) {
          footerNavNutrition.classList.add("active");
        }

        // AI ê¸°ëŠ¥ ëª¨ë‹¬ ì²˜ë¦¬
        const aiFeatureBtn = document.querySelector(".footer-nav-ai-btn");
        const aiFeatureModal = document.getElementById("aiFeatureModal");

        if (aiFeatureBtn && aiFeatureModal) {
          aiFeatureBtn.addEventListener("click", function (e) {
            e.preventDefault();
            aiFeatureModal.classList.toggle("active");
          });

          // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
          document.addEventListener("click", function (e) {
            if (
              !aiFeatureBtn.contains(e.target) &&
              !aiFeatureModal.contains(e.target)
            ) {
              aiFeatureModal.classList.remove("active");
            }
          });
        }
      });
    </script>
  </body>
</html>
